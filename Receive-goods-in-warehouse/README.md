# Receive goods in a warehouse

### Receive items against a Purchase Order and increase available stock.
We will use a combination of **Standard Objects** (Product, Account) and **Custom Objects** (Purchase Order, Inventory).

---

### Entity Relationship Diagram

1.  **Account (Vendor)** owns multiple **Purchase Orders**.
2.  **Purchase Order** contains multiple **PO Line Items**.
3.  **Product** acts as the reference master for **PO Line Items** and **Inventory**.
4.  **Inventory** tracks the live count of a **Product** at a specific location.

---

### 1. Standard Object: Product (`Product2`)

_The master record for the item being scanned. The app queries this to validate the barcode._

| Field Label      | API Name      | Data Type             | Description/Usage                                                                                   |
| :--------------- | :------------ | :-------------------- | :-------------------------------------------------------------------------------------------------- |
| **Product Name** | `Name`        | Text                  | The human-readable name (displayed in app).                                                         |
| **Product Code** | `ProductCode` | Text                  | Internal SKU number.                                                                                |
| **Barcode ID**   | `Barcode__c`  | Text (Unique, Ext ID) | ❗️ **Crucial:** The value stored in the QR/UPC code. The app uses this to find the correct product. |
| **Description**  | `Description` | Long Text             | displayed in the app to help the user identify the item.                                            |

---

### 2. Custom Object: Purchase Order (`Purchase_Order__c`) ❗️

_The "Header" record. The warehouse team scans this first to tell the app which shipment has arrived._

| Field Label           | API Name           | Data Type          | Description/Usage                                                       |
| :-------------------- | :----------------- | :----------------- | :---------------------------------------------------------------------- |
| **PO Number**         | `Name`             | Auto Number        | ❗️ The unique ID (e.g., PO-00123). Generated by Salesforce.             |
| **Vendor**            | `Vendor__c`        | Lookup (`Account`) | ❗️Link to the supplier.                                                 |
| **Order Date**        | `Order_Date__c`    | Date               | ❗️When the order was placed.                                            |
| **Status**            | `Status__c`        | Picklist           | ❗️Values: _Draft, Ordered, Partially Received, Fully Received, Closed_. |
| **Expected Delivery** | `Expected_Date__c` | Date               | ❗️Helps prioritize receiving if multiple POs arrive.                    |

---

### 3. Custom Object: PO Line Item (`PO_Line_Item__c`)

_The specific rows to be updated. The app interacts with this object the most._

| Field Label        | API Name            | Data Type           | Description/Usage                                                        |
| :----------------- | :------------------ | :------------------ | :----------------------------------------------------------------------- |
| **POL Number**     | `Name`              | Auto Number         | ❗️ The unique ID (e.g., POL-00123). Generated by Salesforce.             |
| **Purchase Order** | `Purchase_Order__c` | Master-Detail       | ❗️Links this item to the parent PO.                                      |
| **Product**        | `Product__c`        | Lookup (`Product2`) | ❗️Link to the Product master.                                            |
| **Qty Ordered**    | `Qty_Ordered__c`    | Number (18, 0)      | ❗️How many we expect to get.                                             |
| **Qty Received**   | `Qty_Received__c`   | Number (18, 0)      | ❗️**Target Field:** The app updates this field as items are scanned.     |
| **Qty Remaining**  | `Qty_Remaining__c`  | Formula (Number)    | ❗️Formula: `Qty_Ordered__c - Qty_Received__c`.                           |
| **Line Status**    | `Status__c`         | Formula (Text)      | ❗️Logic: `IF(Qty_Received__c >= Qty_Ordered__c, "Complete", "Pending")`. |

---

### 4. Custom Object: Inventory / Stock (`Inventory__c`)

_The destination record. This tells you what you actually have available to sell/use._

| Field Label       | API Name           | Data Type           | Description/Usage                                  |
| :---------------- | :----------------- | :------------------ | :------------------------------------------------- |
| **Inventory ID**  | `Name`             | Auto Number         | ❗️System ID (e.g., INV-0099).                      |
| **Product**       | `Product__c`       | Lookup (`Product2`) | ❗️Link to the product.                             |
| **Location**      | `Location__c`      | Picklist or Text    | ❗️E.g., "Warehouse A - Aisle 3", "Main Stockroom". |
| **Qty On Hand**   | `Qty_Hand__c`      | Number (18, 0)      | ❗️The live count.                                  |
| **Reorder Point** | `Reorder_Point__c` | Number (18, 0)      | ❗️Minimum stock level before alert triggers.       |

---

### The Data Flow: How BarcodeToCloud Updates This Model

Here is the precise logic flow you would configure in your app or middleware:

#### Step A: Initialization (The App View)

1.  **User Scans PO Document Barcode:** The app queries `Purchase_Order__c` where `Name` matches the scan.
2.  **App Displays:** Vendor Name and a list of related `PO_Line_Item__c` records.

#### Step B: The Receiving Scan (The Loop)

1.  **User Scans Item Barcode:**
    - App queries `Product2` to find the ID based on `Barcode__c`.
    - App matches that Product ID to the `PO_Line_Item__c` list loaded in Step A.
2.  **App Updates Salesforce:**
    - **Target:** `PO_Line_Item__c`
    - **Logic:** `Qty_Received__c` = `Qty_Received__c` + `Scanned_Amount` (usually 1, or user inputs a number).

#### Step C: Automation (Salesforce Flow/Trigger)

_You should not rely on the mobile app to update the Inventory object directly to avoid data conflicts. Let Salesforce handle the heavy lifting._

**Create a "Record-Triggered Flow" on `PO_Line_Item__c`:**

- **Trigger:** When `Qty_Received__c` is changed.
- **Logic:**
  1.  Get the related `Product__c`.
  2.  Find the `Inventory__c` record for that Product (and default Location).
  3.  Add the _difference_ between the old received value and new received value to `Inventory__c.Qty_Hand__c`.

---

### Next Step

If you are a small shop with 1-2 warehouse users and low volume, you don't need to worry about concurrency issues. 

You might want to use a more advanced Transaction/Ledger based model if you have a team of people, high volume, or need strict audit compliance (e.g., medical devices, high-value electronics). [Read More](../Receive-goods-in-warehouse-advanced/README.md)
